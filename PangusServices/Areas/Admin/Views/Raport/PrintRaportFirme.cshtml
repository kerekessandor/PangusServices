@model IEnumerable<PangusServices.Models.Main>

<html>
<head>
    <title>Raport Firma </title>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
            font-size: small;
        }

        .header {
            top: 0px;
            text-align: center;
            position: absolute;
            width: 100%;
        }
    </style>
</head>

<body>
    <h6>SC Pangus Service SRL <br />  RO 7444191 / J19/351/1995 <br /> PL. Sfantu Gheorghe <br /> Tel. 0367 409 500 / 0742 201 098 <br /> Email: pangus@rdsbv.ro</h6>
    <div class="header"><p><b style="font-size:20px">@ViewBag.Client <br />@ViewBag.tim</b></p></div>
    <table style="width:100%">
        <thead>
            <tr>
                <th>Nr.</th>
                <th>Data</th>
                <th>Nr.Înm.</th>
                <th>Client</th>
                <th>Nr.Dev.</th>
                <th>Dimensiune</th>
                <th>RIM</th>
                <th>Anvelope</th>
                <th>Suma platita</th>
                <th>Mentiuni</th>
            </tr>
        </thead>
        @{
            float osszesen = 0;
            var number = 0;
        <tbody>
                @foreach (var item in Model)
                {
                    number++;
                    <tr>
                        <td style="width:2%">@number</td>
                        <td style="width:7%">@Html.DisplayFor(x => item.Customer.Date)</td>
                        <td style="width:9%">@Html.DisplayFor(x => item.CarDetail.NrInmatricular)</td>
                        <td style="width:17%">@Html.DisplayFor(x => item.Customer.Client)</td>
                        <td style="width:3%">@Html.DisplayFor(x => item.MainID)</td>
                        <td style="width:4%">@Html.DisplayFor(x => item.CarDetail.DimensiuneaA)</td>
                        <td style="width:11%">@Html.DisplayFor(x => item.CarDetail.Rim)</td>
                        @if (item.AnvelopeNoi.NoiRulate == true)
                        {
                            <td style="width:11%">@Html.DisplayFor(x => item.AnvelopeNoi.Profil.Anvelope.Marca)</td>
                        }
                        else
                        {
                            <td>Rulate</td>
                        }
                        <td style="text-align:center; width:5%">
                        @{
                            float osszeg = 0;
                            float price = 0;
                            float cantitate = 0;
                            foreach (var sum in item.CustomerServices)
                            {
                                if (item.AnvelopeNoi.NoiRulate == false)
                                {
                                    price = sum.Pret * sum.Cantitate;
                                }
                                else if (item.AnvelopeNoi.Cantitate >= sum.Cantitate && sum.IsEditable)
                                {
                                    price = 0;
                                }
                                else if (sum.IsEditable && sum.Cantitate != null && item.AnvelopeNoi.Cantitate != null)
                                {
                                    cantitate = sum.Cantitate - (float)item.AnvelopeNoi.Cantitate;
                                    price = sum.Pret * (float)cantitate;
                                }
                                else
                                {
                                    price = sum.Pret * sum.Cantitate;
                                }
                                osszeg += price;
                            }
                        }
                        @if (item.Discount == null || item.Discount == 0)
                        {
                            <b>@osszeg.ToString("#,##0.00")</b>
                            osszesen += osszeg;
                        }
                        else
                        {
                            osszeg = (float)(osszeg - ((item.Discount * osszeg) / 100));
                            <b>@osszeg.ToString("#,##0.00")</b>
                            osszesen += osszeg;
                        }
                    </td>
                    <td>@Html.DisplayFor(x => item.CarDetail.Descriere)</td>
                </tr>
            }
        </tbody>
        <tfoot>
            <tr>
                <th colspan="7" style="text-align:right">Total:</th>
                <td style="text-align:center">
                    <b>
                        @osszesen.ToString("#,##0.00")
                    </b>
                </td>
            </tr>
        </tfoot>
     }
    </table>
</body>
</html>